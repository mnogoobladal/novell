#!/bin/bash

# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è Stable Diffusion WebUI –Ω–∞ macOS
# –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–π –Ω–æ–≤–µ–ª–ª—ã

# –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã –Ω–∞ Mac
export COMMANDLINE_ARGS="--medvram --opt-split-attention --disable-safe-unpickle --api --cors-allow-origins=* --enable-insecure-extension-access"

# –û–±—ä—è—Å–Ω–µ–Ω–∏–µ —Ñ–ª–∞–≥–æ–≤:
# --medvram            - –≠–∫–æ–Ω–æ–º–∏—è VRAM (–¥–ª—è Mac —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–π –ø–∞–º—è—Ç—å—é GPU)
# --opt-split-attention - –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è attention –¥–ª—è –ª—É—á—à–µ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏  
# --disable-safe-unpickle - –†–∞–∑—Ä–µ—à–∞–µ—Ç –∑–∞–≥—Ä—É–∑–∫—É NSFW –º–æ–¥–µ–ª–µ–π
# --api               - –í–∫–ª—é—á–∞–µ—Ç API –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –Ω–æ–≤–µ–ª–ª–æ–π
# --cors-allow-origins=* - –†–∞–∑—Ä–µ—à–∞–µ—Ç CORS –¥–ª—è –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
# --enable-insecure-extension-access - –î–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π

echo "üöÄ –ó–∞–ø—É—Å–∫ Stable Diffusion WebUI —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –¥–ª—è –Ω–æ–≤–µ–ª–ª—ã..."
echo "üé® –ù–∞—Å—Ç—Ä–æ–π–∫–∏:"
echo "   - –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–∞–º—è—Ç–∏ GPU –¥–ª—è macOS"
echo "   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ NSFW –∫–æ–Ω—Ç–µ–Ω—Ç–∞"
echo "   - API –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏"
echo "   - –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏"
echo ""

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ webui.sh
if [ ! -f "./stable-diffusion-webui/webui.sh" ]; then
    echo "‚ùå –§–∞–π–ª webui.sh –Ω–µ –Ω–∞–π–¥–µ–Ω!"
    echo "–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã –∑–∞–ø—É—Å–∫–∞–µ—Ç–µ —Å–∫—Ä–∏–ø—Ç –∏–∑ –ø–∞–ø–∫–∏ —Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º WebUI"
    exit 1
fi

# –ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –ø–∞–ø–∫—É WebUI –∏ –∑–∞–ø—É—Å–∫–∞–µ–º
cd stable-diffusion-webui
./webui.sh 